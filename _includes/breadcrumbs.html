{%- comment -%}
  Generates visible breadcrumb navigation and BreadcrumbList JSON-LD
  structured data for:
    - Pages under /travels/ (path-based breadcrumbs)
    - Blog posts (Blog > Year > Month > Post title)
  https://developers.google.com/search/docs/appearance/structured-data/breadcrumb

  Display names are looked up from _data/breadcrumb_names.yml (travels).
  The last item omits "item" in JSON-LD (Google uses the containing page URL).
{%- endcomment -%}

{%- comment -%}--- BLOG POST BREADCRUMBS ---{%- endcomment -%}
{%- if page.layout == "post" and page.date -%}
{%- assign post_year = page.date | date: "%Y" -%}
{%- assign post_month_num = page.date | date: "%m" -%}
{%- assign post_month_name = page.date | date: "%B" -%}
<nav aria-label="Breadcrumb" class="breadcrumbs">
  <ol>
    <li><a href="/all_posts">Blog</a></li>
    <li><a href="/{{ post_year }}/">{{ post_year }}</a></li>
    <li><a href="/{{ post_year }}/{{ post_month_num }}/">{{ post_month_name }}</a></li>
    <li aria-current="page">{{ page.title }}</li>
  </ol>
</nav>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Blog",
      "item": "{{ site.url }}/all_posts"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ post_year }}",
      "item": "{{ site.url }}/{{ post_year }}/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "{{ post_month_name }}",
      "item": "{{ site.url }}/{{ post_year }}/{{ post_month_num }}/"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "{{ page.title }}"
    }
  ]
}
</script>

{%- comment -%}--- TRAVELS BREADCRUMBS ---{%- endcomment -%}
{%- elsif page.url contains '/travels/' -%}
{%- assign clean_url = page.url | replace: '/index.html', '' | replace: '.html', '' -%}
{%- assign url_parts = clean_url | split: '/' -%}
{%- assign part_count = 0 -%}
{%- for segment in url_parts -%}
  {%- if segment != "" -%}{%- assign part_count = part_count | plus: 1 -%}{%- endif -%}
{%- endfor -%}
{%- if part_count >= 2 %}
<nav aria-label="Breadcrumb" class="breadcrumbs">
  <ol>
    {%- assign crumb_path = "" -%}
    {%- assign position = 0 -%}
    {%- for segment in url_parts -%}
      {%- if segment != "" -%}
        {%- assign position = position | plus: 1 -%}
        {%- assign crumb_path = crumb_path | append: "/" | append: segment -%}
        {%- assign crumb_name = site.data.breadcrumb_names[segment] | default: segment -%}
        {%- if position == part_count %}
    <li aria-current="page">{{ crumb_name }}</li>
        {%- else %}
    <li><a href="{{ crumb_path }}">{{ crumb_name }}</a></li>
        {%- endif -%}
      {%- endif -%}
    {%- endfor %}
  </ol>
</nav>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {%- assign crumb_path = "" -%}
    {%- assign position = 0 -%}
    {%- for segment in url_parts -%}
      {%- if segment != "" -%}
        {%- assign position = position | plus: 1 -%}
        {%- assign crumb_path = crumb_path | append: "/" | append: segment -%}
        {%- assign crumb_name = site.data.breadcrumb_names[segment] | default: segment -%}
        {%- if position == part_count %}
    {
      "@type": "ListItem",
      "position": {{ position }},
      "name": "{{ crumb_name }}"
    }
        {%- else %}
    {
      "@type": "ListItem",
      "position": {{ position }},
      "name": "{{ crumb_name }}",
      "item": "{{ site.url }}{{ crumb_path }}"
    },
        {%- endif -%}
      {%- endif -%}
    {%- endfor %}
  ]
}
</script>
{%- endif -%}
{%- endif -%}
